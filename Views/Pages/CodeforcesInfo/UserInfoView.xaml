<UserControl x:Class="Tools.Views.Pages.CodeforcesInfo.UserInfoView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:models="clr-namespace:Tools.Models"
             xmlns:controls="clr-namespace:Tools.Controls"
             xmlns:converters="clr-namespace:Tools.Converters"
             xmlns:codeforcesInfoPage="clr-namespace:Tools.ViewModel.CodeforcesInfoPage"
             d:DataContext="{d:DesignInstance Type=codeforcesInfoPage:CodeforcesInfoViewModel}"
             mc:Ignorable="d"
             d:DesignHeight="550"
             d:DesignWidth="692"
             ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
             ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}">
    <UserControl.Resources>
        <!-- 转换器 -->
        <converters:BooleanToVisibleConverter x:Key="BooleanToVisibleConverter" />
        <converters:OnlineStatusToColorConverter x:Key="OnlineStatusToColorConverter" />
        <converters:OnlineStatusToTextConverter x:Key="OnlineStatusToTextConverter" />
    </UserControl.Resources>
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="60" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <!-- 标题及工具栏 -->
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,0,16">
                <ui:SymbolIcon Symbol="Person32"
                               Filled="True"
                               FontSize="24"
                               Margin="0,0,12,0"
                               Foreground="#4CAF50" />

                <ui:TextBlock Text="{Binding UserInfoTitle}"
                              FontTypography="Title"
                              VerticalAlignment="Center"
                              FontSize="24"
                              Foreground="#FFFFFF" />
            </StackPanel>
            <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="0,0,0,16">
                <ui:Button Icon="{ui:SymbolIcon Settings16, FontSize=22, Filled=True}"
                           Width="42" Height="42" IsEnabled="{Binding FinishedUserInfoLoading}"
                           Background="Transparent" BorderBrush="Transparent"
                           Command="{Binding SettingUserInfoCommand}"
                           Margin="5, 0" />

                <ui:Button Icon="{ui:SymbolIcon ArrowSync24, FontSize=22, Filled=True}"
                           Width="42" Height="42" IsEnabled="{Binding FinishedUserInfoLoading}"
                           Background="Transparent" BorderBrush="Transparent"
                           Command="{Binding RefreshUserInfoAndFriendsCommand}"
                           Margin="5, 0" />
            </StackPanel>
        </Grid>

        <!-- 加载中动画 -->
        <controls:LoadingBox Grid.Row="1" LoadingMessage="{Binding UserInfoLoadingMessage}"
                             IsActive="{Binding IsUserInfoLoading}" />

        <!-- 主展示区 -->
        <ui:DynamicScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto"
                                Visibility="{Binding IsUserInfoLoading, Converter={StaticResource BooleanToVisibleConverter}, ConverterParameter=True}">
            <Grid>
                <!-- 主信息区 -->
                <Grid Margin="0,16,0,0"
                      Visibility="{Binding HasUserInfoError, Converter={StaticResource BooleanToVisibleConverter}, ConverterParameter=True}">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- 用户信息卡片 -->
                    <ui:Border Grid.Row="0" Background="#1E1E1E" CornerRadius="12" Padding="16">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <!-- 用户头像 -->
                            <Border Grid.Column="0"
                                    Width="96" Height="96"
                                    CornerRadius="48"
                                    Background="#333333"
                                    Margin="0,0,16,0"
                                    BorderBrush="{Binding UserInfo.CurColor}"
                                    BorderThickness="2">
                                <Grid>
                                    <!-- 头像图片 -->
                                    <Image Source="{Binding UserInfo.TitlePhoto}"
                                           Stretch="Fill"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center">
                                        <Image.Clip>
                                            <EllipseGeometry Center="46,46" RadiusX="46" RadiusY="46" />
                                        </Image.Clip>
                                    </Image>
                                </Grid>
                            </Border>

                            <!-- 用户基本信息 -->
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <ui:TextBlock Text="{Binding UserInfo.Handle}"
                                              FontSize="24"
                                              FontWeight="Bold"
                                              Foreground="White"
                                              Margin="0,0,0,4" />

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <ui:Border
                                        Background="{Binding UserInfo.CurColor}"
                                        CornerRadius="6"
                                        Padding="6,4">
                                        <ui:TextBlock Text="{Binding UserInfo.Rank}"
                                                      FontWeight="Bold" Foreground="White" />
                                    </ui:Border>
                                </StackPanel>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <!--最后在线时间-->
                                    <ui:TextBlock Grid.Column="0"
                                                  Text="{Binding UserInfo.LastOnlineTime, StringFormat=最后在线: yyyy-MM-dd HH:mm}"
                                                  Foreground="#AAAAAA"
                                                  FontSize="14" />

                                    <!-- 分割线 -->
                                    <Separator Grid.Column="1"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Center"
                                               Margin="8,0"
                                               Height="20"
                                               Background="White" />

                                    <!-- 注册时间 -->
                                    <ui:TextBlock Grid.Column="2"
                                                  Text="{Binding UserInfo.RegistrationTime, StringFormat=注册时间: yyyy-MM-dd HH:mm}"
                                                  Foreground="#AAAAAA"
                                                  FontSize="14"
                                                  HorizontalAlignment="Right" />
                                </Grid>
                            </StackPanel>
                        </Grid>
                    </ui:Border>

                    <!-- 评级信息卡片 -->
                    <ui:Border Grid.Row="1" Background="#1E1E1E" CornerRadius="12"
                               Padding="16" Margin="0,16,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- 当前评级 -->
                            <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                <ui:TextBlock Text="当前评级" Foreground="#AAAAAA"
                                              HorizontalAlignment="Center"
                                              FontSize="14" Margin="0,0,0,8" />

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <ui:Border Background="White"
                                               CornerRadius="6"
                                               Padding="5">
                                        <ui:TextBlock Text="{Binding UserInfo.Rating}"
                                                      FontSize="24" FontWeight="Bold"
                                                      TextAlignment="Center"
                                                      Foreground="{Binding UserInfo.CurColor}" />
                                    </ui:Border>
                                </StackPanel>
                            </StackPanel>

                            <!-- 分割线 -->
                            <Separator Grid.Column="1"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Center"
                                       Margin="8,0"
                                       Height="60"
                                       Background="White" />

                            <!-- 最高评级 -->
                            <StackPanel Grid.Column="2" Margin="8,0,0,0">
                                <ui:TextBlock Text="最高评级" Foreground="#AAAAAA"
                                              HorizontalAlignment="Center"
                                              FontSize="14" Margin="0,0,0,8" />

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <ui:Border Background="White"
                                               CornerRadius="6"
                                               Padding="5">
                                        <ui:TextBlock Text="{Binding UserInfo.MaxRating}"
                                                      FontSize="24" FontWeight="Bold"
                                                      TextAlignment="Center"
                                                      Foreground="{Binding UserInfo.MaxColor}" />
                                    </ui:Border>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </ui:Border>

                    <!-- Rating变化卡片 -->
                    <ui:Border Grid.Row="3" Background="#1E1E1E" CornerRadius="12"
                               Padding="16" Margin="0,16,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <!-- Rating变化标题 -->
                            <Grid Grid.Row="0" Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <!-- 标题 -->
                                <ui:TextBlock Grid.Column="0" Text="Rating变化" Foreground="#AAAAAA"
                                              HorizontalAlignment="Center"
                                              FontSize="14" Margin="0,0,0,8" />
                                <!-- 显示数量选择框 -->
                                <StackPanel Grid.Column="2" Orientation="Horizontal"
                                            VerticalAlignment="Center">
                                    <ui:TextBlock Text="展示数据数量" Foreground="#AAAAAA"
                                                  HorizontalAlignment="Center"
                                                  FontSize="14" Margin="0,0,8,8" />
                                    <ui:NumberBox Width="100" TextAlignment="Center" FontSize="14"
                                                  Minimum="0" ClearButtonEnabled="False" SmallChange="1"
                                                  LargeChange="1"
                                                  Maximum="{Binding MaxShowCount}" Padding="8,4"
                                                  Value="{Binding ShowCount, UpdateSourceTrigger=PropertyChanged}" />
                                </StackPanel>
                            </Grid>

                            <!-- 内容区域 -->
                            <Grid Grid.Row="1">
                                <ui:DynamicScrollViewer VerticalScrollBarVisibility="Auto"
                                                        HorizontalScrollBarVisibility="Disabled"
                                                        MaxHeight="400" Padding="8">
                                    <ItemsControl ItemsSource="{Binding VisibleChanges}"
                                                  VirtualizingPanel.IsVirtualizing="True"
                                                  VirtualizingPanel.VirtualizationMode="Recycling"
                                                  VirtualizingPanel.CacheLength="5,5">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate DataType="{x:Type models:RatingChangeModel}">
                                                <ui:Border Padding="16" Margin="5"
                                                           CornerRadius="12" Background="#1E1E1E"
                                                           BorderBrush="#333333" BorderThickness="1">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                        </Grid.ColumnDefinitions>

                                                        <!-- 评级变化值 -->
                                                        <ui:Border Grid.Column="0"
                                                                   VerticalAlignment="Center"
                                                                   HorizontalAlignment="Center"
                                                                   Padding="5, 8" Margin="5"
                                                                   CornerRadius="12" Background="#222222"
                                                                   BorderBrush="#555555"
                                                                   BorderThickness="1">
                                                            <ui:TextBlock
                                                                Text="{Binding RatingChangeDisplay}"
                                                                FontSize="16" FontWeight="Bold"
                                                                Foreground="{Binding ChangeColor}" />
                                                        </ui:Border>

                                                        <!-- 比赛信息 -->
                                                        <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                                            <ui:TextBlock Text="{Binding ContestName}"
                                                                          FontSize="16"
                                                                          FontWeight="SemiBold"
                                                                          Foreground="White"
                                                                          TextWrapping="Wrap"
                                                                          Margin="0,0,0,8" />
                                                            <Grid>
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto" />
                                                                    <RowDefinition Height="Auto" />
                                                                    <RowDefinition Height="Auto" />
                                                                </Grid.RowDefinitions>

                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto" />
                                                                    <ColumnDefinition Width="*" />
                                                                </Grid.ColumnDefinitions>

                                                                <!-- 更新时间 -->
                                                                <ui:TextBlock Grid.Row="0" Grid.Column="0"
                                                                              Text="更新时间: "
                                                                              FontSize="14"
                                                                              Foreground="#AAAAAA"
                                                                              Margin="0,0,0,4" />

                                                                <ui:TextBlock Grid.Row="0" Grid.Column="1"
                                                                              Text="{Binding RatingUpdateTime, StringFormat='yyyy-MM-dd HH:mm'}"
                                                                              FontSize="14"
                                                                              Foreground="White"
                                                                              Margin="0,0,0,4" />

                                                                <!-- 排名 -->
                                                                <ui:TextBlock Grid.Row="1" Grid.Column="0"
                                                                              Text="排名: "
                                                                              FontSize="14"
                                                                              Foreground="#AAAAAA"
                                                                              Margin="0,0,0,4" />

                                                                <ui:TextBlock Grid.Row="1" Grid.Column="1"
                                                                              Text="{Binding Rank}"
                                                                              FontSize="14"
                                                                              Foreground="White"
                                                                              Margin="0,0,0,4" />

                                                                <!-- 比赛ID -->
                                                                <ui:TextBlock Grid.Row="2" Grid.Column="0"
                                                                              Text="比赛ID: "
                                                                              FontSize="14"
                                                                              Foreground="#AAAAAA"
                                                                              Margin="0,0,0,4" />

                                                                <ui:TextBlock Grid.Row="2" Grid.Column="1"
                                                                              Text="{Binding ContestId}"
                                                                              FontSize="14"
                                                                              Foreground="White"
                                                                              Margin="0,0,0,4" />
                                                            </Grid>
                                                        </StackPanel>

                                                        <Grid Grid.Column="2">
                                                            <!-- 评级值 -->
                                                            <StackPanel Orientation="Vertical"
                                                                        VerticalAlignment="Center"
                                                                        HorizontalAlignment="Right"
                                                                        Visibility="{Binding GainScore, Converter={StaticResource BooleanToVisibleConverter}}">
                                                                <!-- 得分 -->
                                                                <ui:TextBlock Text="{Binding NewRating}"
                                                                              FontSize="16" FontWeight="Bold"
                                                                              Foreground="{Binding ChangeColor}" />

                                                                <ui:SymbolIcon Symbol="ArrowSortUp24"
                                                                               Margin="0,20"
                                                                               FontSize="24" Foreground="#AAAAAA" />

                                                                <ui:TextBlock Text="{Binding OldRating}"
                                                                              FontSize="16" Foreground="#BBBBBB"
                                                                              TextDecorations="Strikethrough" />
                                                            </StackPanel>

                                                            <!-- 掉分 -->
                                                            <StackPanel Orientation="Vertical"
                                                                        VerticalAlignment="Center"
                                                                        HorizontalAlignment="Right"
                                                                        Visibility="{Binding GainScore, Converter={StaticResource BooleanToVisibleConverter}, ConverterParameter=True}">
                                                                <ui:TextBlock Text="{Binding OldRating}"
                                                                              FontSize="16" Foreground="#BBBBBB"
                                                                              TextDecorations="Strikethrough" />

                                                                <ui:SymbolIcon Symbol="ArrowSortDown24"
                                                                               Margin="0,20"
                                                                               FontSize="24" Foreground="#AAAAAA" />

                                                                <ui:TextBlock Text="{Binding NewRating}"
                                                                              FontSize="16" FontWeight="Bold"
                                                                              Foreground="{Binding ChangeColor}" />
                                                            </StackPanel>
                                                        </Grid>
                                                    </Grid>
                                                </ui:Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <VirtualizingStackPanel />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                </ui:DynamicScrollViewer>

                                <!-- 无数据提示 -->
                                <ui:TextBlock Text="暂无Rating变化数据 或 设定展示数量为 0"
                                              Margin="15"
                                              Visibility="{Binding HasData, Converter={StaticResource BooleanToVisibleConverter}, ConverterParameter=True}"
                                              FontSize="16"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              TextAlignment="Center" />
                            </Grid>
                        </Grid>
                    </ui:Border>

                    <!-- 好友列表卡片 -->
                    <ui:Border Grid.Row="4" Background="#1E1E1E" CornerRadius="12"
                               Padding="16" Margin="0,16,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="60" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <!-- 好友列表标题 -->
                            <Grid Grid.Row="0" Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <!-- 标题 -->
                                <ui:TextBlock Grid.Column="0" Text="{Binding FriendsListTitle}"
                                              Foreground="#AAAAAA"
                                              HorizontalAlignment="Center" VerticalAlignment="Center"
                                              FontSize="14" Margin="0,0,0,8" />

                                <!-- 操作按钮 -->
                                <StackPanel Grid.Column="2" Orientation="Horizontal"
                                            VerticalAlignment="Center">
                                    <ui:Button Icon="{ui:SymbolIcon ArrowSync24, FontSize=18, Filled=True}"
                                               Width="38" Height="38"
                                               IsEnabled="{Binding FinishedFriendsLoading}"
                                               Background="Transparent" BorderBrush="Transparent"
                                               Command="{Binding RefreshFriendsCommand}"
                                               Margin="5, 0" />
                                </StackPanel>
                            </Grid>

                            <!-- 加载中动画 -->
                            <controls:LoadingBox Grid.Row="1" LoadingMessage="{Binding FriendsLoadingMessage}"
                                                 IsActive="{Binding IsFriendsLoading}" />

                            <!-- 主展示区 -->
                            <ui:DynamicScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto"
                                                    MaxHeight="400"
                                                    Visibility="{Binding IsFriendsLoading, Converter={StaticResource BooleanToVisibleConverter}, ConverterParameter=True}">
                                <Grid>
                                    <Grid Margin="0,16,0,0"
                                          Visibility="{Binding HasFriendsError, Converter={StaticResource BooleanToVisibleConverter}, ConverterParameter=True}">
                                        <!-- 好友列表 -->
                                        <ItemsControl ItemsSource="{Binding Friends}"
                                                      VirtualizingPanel.IsVirtualizing="True"
                                                      VirtualizingPanel.VirtualizationMode="Recycling"
                                                      VirtualizingPanel.CacheLength="5,5">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate DataType="{x:Type models:FriendModel}">
                                                    <ui:Border Background="#1E1E1E"
                                                               CornerRadius="12"
                                                               BorderThickness="1"
                                                               BorderBrush="#333333"
                                                               Margin="0,0,0,16"
                                                               Padding="16">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" />
                                                                <ColumnDefinition Width="Auto" />
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="Auto" />
                                                            </Grid.ColumnDefinitions>

                                                            <!-- 好友头像 -->
                                                            <Border Grid.Column="0"
                                                                    Width="72" Height="72"
                                                                    CornerRadius="36"
                                                                    Background="#333333"
                                                                    Margin="0,0,16,0"
                                                                    BorderBrush="{Binding CurColor}"
                                                                    BorderThickness="2">
                                                                <Grid>
                                                                    <Image Source="{Binding TitlePhoto}"
                                                                           Stretch="Fill"
                                                                           HorizontalAlignment="Center"
                                                                           VerticalAlignment="Center">
                                                                        <Image.Clip>
                                                                            <EllipseGeometry Center="34,34"
                                                                                RadiusX="34" RadiusY="34" />
                                                                        </Image.Clip>
                                                                    </Image>

                                                                    <!-- 在线状态指示器 -->
                                                                    <Ellipse Width="16" Height="16"
                                                                             Fill="{Binding IsOnline, Converter={StaticResource OnlineStatusToColorConverter}}"
                                                                             Stroke="#1E1E1E"
                                                                             StrokeThickness="2"
                                                                             HorizontalAlignment="Right"
                                                                             VerticalAlignment="Bottom"
                                                                             Margin="-4,-4,0,0" />
                                                                </Grid>
                                                            </Border>

                                                            <!-- 好友信息 -->
                                                            <StackPanel Grid.Column="1"
                                                                        VerticalAlignment="Center">
                                                                <ui:TextBlock Text="{Binding Handle}"
                                                                              FontSize="18"
                                                                              FontWeight="SemiBold"
                                                                              Foreground="White"
                                                                              Margin="0,0,0,8" />

                                                                <StackPanel Orientation="Horizontal"
                                                                            Margin="0,0,0,8">
                                                                    <ui:Border
                                                                        Background="{Binding CurColor}"
                                                                        CornerRadius="6"
                                                                        Padding="6,4"
                                                                        Margin="0,0,8,0">
                                                                        <ui:TextBlock Text="{Binding Rank}"
                                                                            FontWeight="Bold"
                                                                            Foreground="White" />
                                                                    </ui:Border>
                                                                </StackPanel>

                                                                <!-- 在线状态 -->
                                                                <ui:TextBlock
                                                                    Visibility="{Binding IsOnline, Converter={StaticResource BooleanToVisibleConverter}, ConverterParameter=True}"
                                                                    Text="{Binding LastOnlineTime, StringFormat=最后在线: yyyy-MM-dd HH:mm}"
                                                                    FontSize="14" Foreground="#AAAAAA" />
                                                            </StackPanel>

                                                            <!-- Rating展示 -->
                                                            <StackPanel Grid.Column="2"
                                                                        Orientation="Horizontal"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center">
                                                                <ui:TextBlock VerticalAlignment="Center"
                                                                              TextAlignment="Right"
                                                                              Text="当前Rating: " FontSize="17"
                                                                              Foreground="#AAAAAA"
                                                                              Margin="0,0,8,0" />

                                                                <ui:Border Background="White" Width="80"
                                                                           CornerRadius="6" Padding="6,4">
                                                                    <ui:TextBlock TextAlignment="Center"
                                                                        Text="{Binding Rating}"
                                                                        FontWeight="Bold" FontSize="28"
                                                                        Foreground="{Binding CurColor}" />
                                                                </ui:Border>
                                                            </StackPanel>

                                                            <!-- 在线状态文本 -->
                                                            <ui:TextBlock Grid.Column="3"
                                                                          Text="{Binding IsOnline, Converter={StaticResource OnlineStatusToTextConverter}}"
                                                                          FontSize="16"
                                                                          FontWeight="Bold"
                                                                          Foreground="{Binding IsOnline, Converter={StaticResource OnlineStatusToColorConverter}}"
                                                                          VerticalAlignment="Center"
                                                                          Margin="16,0,0,0" />
                                                        </Grid>
                                                    </ui:Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <VirtualizingStackPanel />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                        </ItemsControl>

                                        <!-- 无好友提示 -->
                                        <Grid Margin="0,100,0,0"
                                              Visibility="{Binding HasFriends, Converter={StaticResource BooleanToVisibleConverter}, ConverterParameter=True}">
                                            <StackPanel HorizontalAlignment="Center">
                                                <ui:SymbolIcon Symbol="People16"
                                                               Width="48"
                                                               Height="48"
                                                               FontSize="48"
                                                               Foreground="#AAAAAA"
                                                               Margin="0,0,0,16"
                                                               HorizontalAlignment="Center" />

                                                <ui:TextBlock Text="您还没有任何好友"
                                                              FontSize="20"
                                                              FontWeight="Bold"
                                                              Foreground="White"
                                                              HorizontalAlignment="Center"
                                                              TextWrapping="Wrap"
                                                              TextAlignment="Center" />
                                            </StackPanel>
                                        </Grid>
                                    </Grid>

                                    <!-- 错误信息 -->
                                    <controls:ErrorBox IsActive="{Binding HasFriendsError}"
                                                       ErrorMessage="{Binding FriendsErrorMessage}" />
                                </Grid>
                            </ui:DynamicScrollViewer>
                        </Grid>
                    </ui:Border>
                </Grid>

                <!-- 错误信息 -->
                <controls:ErrorBox IsActive="{Binding HasUserInfoError}"
                                   ErrorMessage="{Binding UserInfoErrorMessage}" />
            </Grid>
        </ui:DynamicScrollViewer>
    </Grid>
</UserControl>